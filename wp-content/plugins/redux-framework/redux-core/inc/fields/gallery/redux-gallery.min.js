!function(r){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.gallery=redux.field_objects.gallery||{},redux.field_objects.gallery.init=function(e){e=e||r(document).find(".redux-container-gallery:visible"),r(e).each(function(){var e=r(this),i=e;e.hasClass("redux-field-container")||(i=e.parents(".redux-field-container:first")),i.is(":hidden")||i.hasClass("redux-field-init")&&(i.removeClass("redux-field-init"),e.on({click:function(e){var n,i,l,t,a,d,s;return wp.media.view.Settings.Gallery=wp.media.view.Settings.Gallery.extend({template:function(){}}),n=r(this).closest("fieldset"),"clear-gallery"===e.currentTarget.id?(n.find(".gallery_values").val(""),void n.find(".screenshot").html("")):"undefined"!=typeof wp&&wp.media&&wp.media.gallery?(e.preventDefault(),i=(l=n.find(".gallery_values").val())?'[gallery ids="'+l+'"]':'[gallery ids="0"]',t=wp.media.gallery.edit(i),l||(a=r("body").find("#"+t.el.id),s=a.find(".uploader-inline"),d=a.find(".media-toolbar .spinner"),setTimeout(function(){s.hasClass("hidden")&&(s.removeClass("hidden"),d.removeClass("is-active"))},400)),t.state("gallery-edit").on("update",function(e){var i,l,a,d;n.find(".screenshot").html(""),i=e.models.map(function(e){return l=e.toJSON(),a=void 0!==l.sizes&&void 0!==l.sizes.thumbnail?l.sizes.thumbnail.url:l.url,d='<a class="of-uploaded-image" href="'+a+'"><img class="redux-option-image" src="'+a+'" alt="" /></a>',n.find(".screenshot").append(d),e.id}),n.find(".gallery_values").val(i.join(",")),redux_change(n.find(".gallery_values")),t.detach()}),!1):void 0}},".gallery-attachments"))})}}(jQuery);